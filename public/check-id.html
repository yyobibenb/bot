<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ ID</title>
  <style>
    body {
      font-family: monospace;
      background: #1a1a2e;
      color: #fff;
      padding: 20px;
      line-height: 1.8;
    }
    .box {
      background: rgba(255,255,255,0.1);
      padding: 15px;
      margin: 10px 0;
      border-radius: 8px;
      border-left: 4px solid #00ff00;
    }
    .error {
      border-left-color: #ff0000;
    }
    .value {
      color: #00ff00;
      font-weight: bold;
      font-size: 16px;
    }
    .label {
      color: #888;
      font-size: 12px;
    }
  </style>
</head>
<body>
  <h1>üîç –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ ID</h1>

  <div class="box" id="url-box">
    <div class="label">–ü–æ–ª–Ω—ã–π URL:</div>
    <div class="value" id="url"></div>
  </div>

  <div class="box" id="params-box">
    <div class="label">URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (window.location.search):</div>
    <div class="value" id="params"></div>
  </div>

  <div class="box" id="tgid-box">
    <div class="label">tg_id –∏–∑ URL:</div>
    <div class="value" id="tgid"></div>
  </div>

  <div class="box" id="sdk-box">
    <div class="label">Telegram SDK –¥–æ—Å—Ç—É–ø–µ–Ω:</div>
    <div class="value" id="sdk"></div>
  </div>

  <div class="box" id="sdk-id-box">
    <div class="label">ID –∏–∑ Telegram SDK:</div>
    <div class="value" id="sdk-id"></div>
  </div>

  <div class="box" id="result-box">
    <div class="label">–ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</div>
    <div class="value" id="result"></div>
  </div>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script>
    console.log('=== –ë–´–°–¢–†–ê–Ø –ü–†–û–í–ï–†–ö–ê ID ===');

    // 1. –ü–æ–ª–Ω—ã–π URL
    const fullUrl = window.location.href;
    document.getElementById('url').textContent = fullUrl;
    console.log('1. –ü–æ–ª–Ω—ã–π URL:', fullUrl);

    // 2. URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    const params = window.location.search;
    document.getElementById('params').textContent = params || '‚ùå –ü–£–°–¢–û!';
    console.log('2. URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:', params);

    // 3. tg_id –∏–∑ URL
    const urlParams = new URLSearchParams(params);
    const tgId = urlParams.get('tg_id');
    document.getElementById('tgid').textContent = tgId || '‚ùå –ù–ï–¢!';
    console.log('3. tg_id –∏–∑ URL:', tgId);

    if (!tgId) {
      document.getElementById('tgid-box').classList.add('error');
    }

    // 4. Telegram SDK
    const hasSdk = !!(window.Telegram && window.Telegram.WebApp);
    document.getElementById('sdk').textContent = hasSdk ? '‚úÖ –î–ê' : '‚ùå –ù–ï–¢';
    console.log('4. Telegram SDK –¥–æ—Å—Ç—É–ø–µ–Ω:', hasSdk);

    // 5. ID –∏–∑ SDK
    let sdkId = null;
    if (hasSdk) {
      const tg = window.Telegram.WebApp;
      tg.ready();
      if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
        sdkId = tg.initDataUnsafe.user.id;
      }
    }
    document.getElementById('sdk-id').textContent = sdkId || '‚ùå –ù–ï–¢';
    console.log('5. ID –∏–∑ Telegram SDK:', sdkId);

    // 6. –ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    const finalId = tgId || sdkId;
    const resultBox = document.getElementById('result-box');
    const resultEl = document.getElementById('result');

    if (finalId) {
      resultEl.textContent = `‚úÖ ID –Ω–∞–π–¥–µ–Ω: ${finalId}`;
      resultEl.style.color = '#00ff00';
      console.log('‚úÖ –ò–¢–û–ì: ID –Ω–∞–π–¥–µ–Ω:', finalId);

      if (tgId) {
        resultEl.textContent += ' (–∏–∑ URL)';
        console.log('   –ò—Å—Ç–æ—á–Ω–∏–∫: URL –ø–∞—Ä–∞–º–µ—Ç—Ä tg_id');
      } else {
        resultEl.textContent += ' (–∏–∑ Telegram SDK)';
        console.log('   –ò—Å—Ç–æ—á–Ω–∏–∫: Telegram SDK');
      }
    } else {
      resultBox.classList.add('error');
      resultEl.textContent = '‚ùå ID –ù–ï –ù–ê–ô–î–ï–ù!';
      resultEl.style.color = '#ff0000';
      console.log('‚ùå –ò–¢–û–ì: ID –ù–ï –ù–ê–ô–î–ï–ù!');
      console.log('');
      console.log('üîß –ß–¢–û –î–ï–õ–ê–¢–¨:');
      console.log('1. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ WEB_APP_URL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ .env');
      console.log('2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ –±–æ—Ç–∞');
      console.log('3. –û—Ç–ø—Ä–∞–≤—å /start –∑–∞–Ω–æ–≤–æ –≤ –±–æ—Ç–µ');
      console.log('4. –ù–∞–∂–º–∏ –Ω–∞ –ù–û–í–£–Æ –∫–Ω–æ–ø–∫—É "üöÄ –û—Ç–∫—Ä—ã—Ç—å Mini App"');
    }

    console.log('');
    console.log('üìã –î–û–õ–ñ–ï–ù –ë–´–¢–¨ URL:');
    console.log('   https://your-app.com?tg_id=123456789');
    console.log('');
    console.log('‚ùå –ù–ï –î–û–õ–ñ–ù–û –ë–´–¢–¨:');
    console.log('   https://your-app.com (–±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)');
    console.log('   https://your-app.com?user_id=... (—Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç)');
  </script>
</body>
</html>
