# 📱 Карточка проверки данных в Mini App

## Где находится

Откройте Mini App → вкладка **Профиль** → под балансом увидите **золотую карточку**:

```
┌───────────────────────────────────────┐
│ 📋 Проверка передачи данных          │
├───────────────────────────────────────┤
│ Telegram ID:     123456789           │
│ Источник данных: ✅ URL параметры     │
│ URL параметры:   ✅ Да               │
│ Аватар:          ✅ Есть             │
│ Полный URL:      https://...?user_id │
├───────────────────────────────────────┤
│ 💡 Где смотреть: Эта карточка        │
│ показывает как данные попали в Mini  │
│ App. Если "URL параметры: ❌ Нет" -  │
│ проверь .env и перезапусти бота.     │
└───────────────────────────────────────┘
```

## Что показывает

### ✅ Если данные ПЕРЕДАЮТСЯ через URL

```
Telegram ID:     123456789
Источник данных: ✅ URL параметры  ← ВОТ ЭТО ГЛАВНОЕ!
URL параметры:   ✅ Да
Аватар:          ✅ Есть
Полный URL:      https://your-app.com?user_id=123456789&first_name=John&...
```

**Это значит:** Бот правильно передает данные через URL! Всё работает! 🎉

### ❌ Если данные НЕ передаются

```
Telegram ID:     123456789
Источник данных: 📱 Telegram SDK  ← ПРОБЛЕМА ТУТ!
URL параметры:   ❌ Нет           ← И ТУТ!
Аватар:          ❌ Нет
Полный URL:      https://your-app.com
```

**Это значит:** Данные берутся из Telegram SDK вместо URL параметров. URL не содержит параметров!

### 🔧 Что делать если ❌ Нет

1. **Проверь `.env`** - правильный ли `WEB_APP_URL`
2. **Перезапусти бота** - иначе изменения не применятся
3. **Отправь `/start` заново** - получи новую кнопку
4. **Открой Mini App** - по новой кнопке

## Дополнительная проверка

### В консоли браузера (F12)

Открой DevTools и запусти:
```javascript
checkMyStatus()
```

Увидишь полную информацию:
```
=== 📊 СТАТУС ПОЛЬЗОВАТЕЛЯ ===
URL параметры: {user_id: "123456789", first_name: "John", ...}
Данные из URL: {id: 123456789, first_name: "John", ...}
Текущий пользователь: {id: 1, telegram_id: 123456789, ...}
Является админом: false
```

### В консоли сервера

После `/start` в **консоли сервера** (не браузера!) должно быть:
```
🌐 Базовый URL из .env: https://your-app.com
📋 Формирую URL с данными пользователя:
  - telegram_id: 123456789
  - first_name: John
  - last_name: Doe
  - username: johndoe
  - is_premium: false
  - photo_url: https://api.telegram.org/file/bot.../photo.jpg
✅ Сформирован URL: https://your-app.com?user_id=123456789&first_name=John&...
```

## Файлы изменены

- **public/index.html** (строки 29-57) - золотая карточка в профиле
- **public/app.js** (строки 86-91, 124-129) - заполнение данных карточки
- **src/bot/telegramBot.ts** (строка 38) - логирование базового URL

## Стиль карточки

- **Фон:** Золотой градиент с тенью
- **Рамка:** 2px золотая
- **Каждая строка:** В отдельном блоке с закругленными углами
- **Подсказка внизу:** Синий блок с инструкцией

Карточка выделяется на фоне остальных элементов профиля, чтобы сразу было видно!
